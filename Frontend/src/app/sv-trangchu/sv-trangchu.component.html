<body>
    <div class="container">
        <!-- Main Content -->
        <main class="main-content">
            <!-- Content -->
            <div class="content">

                <!-- (tuỳ chọn) Thông báo lỗi -->
                <div class="error-message" *ngIf="errorMessage">
                    {{ errorMessage }}
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <!-- Điểm trung bình (GPA) -->
                    <div class="stat-card gpa">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-label">
                            Điểm trung bình
                        </div>
                        <div class="stat-value" id="gpaValue">
                            {{ dashboard?.gpa | number:'1.2-2' }}
                        </div>
                    </div>

                    <!-- Tỉ lệ qua môn -->
                    <div class="stat-card pass-rate">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-label">
                            Tỉ lệ qua môn
                        </div>
                        <div class="stat-value" id="passRateValue">
                            {{ dashboard?.passRate | number:'1.0-1' }}%
                        </div>
                    </div>

                    <!-- Số buổi vắng -->
                    <div class="stat-card absent">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-label">
                            Số buổi vắng
                        </div>
                        <div class="stat-value" id="absentValue">
                            {{ dashboard?.absentCount || 0 }}
                        </div>
                    </div>

                    <!-- Tỉ lệ điểm danh -->
                    <div class="stat-card attendance">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-label">
                            Tỉ lệ điểm danh
                        </div>
                        <div class="stat-value" id="attendanceValue">
                            {{ dashboard?.attendanceRate | number:'1.0-1' }}%
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-section">
                    <!-- Biểu đồ cột: Điểm số theo lớp học -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h2 class="chart-title">Điểm số theo lớp học</h2>
                        </div>
                        <div class="line-chart">
                            <div class="chart-bar" *ngFor="let item of gradeBars"
                                [style.height.%]="getBarHeight(item.finalGrade)"
                                [attr.data-value]="item.finalGrade | number:'1.1-1'">
                                
                            </div>
                    
                        </div>
                        <div class="chart-labels">
                            <div class="chart-label" *ngFor="let item of gradeBars">
                                {{ item.className }}
                            </div>
                        </div>
                    </div>

                    <!-- Biểu đồ tròn: Tỉ lệ điểm danh -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h2 class="chart-title">Tỉ lệ điểm danh</h2>
                        </div>
                        <div class="pie-chart-container">
                            <div class="pie-chart" [ngStyle]="{'background-image': pieBackground}">
                                <div class="pie-center">
                                    <div class="pie-center-value">
                                        {{ dashboard?.attendanceRate | number:'1.0-1' }}%
                                    </div>
                                    <div class="pie-center-label">
                                        Tổng thể
                                    </div>
                                </div>
                            </div>

                            <div class="pie-legend">
                                <div class="legend-item">
                                    <div class="legend-label">
                                        <div class="legend-color present"></div> Có mặt
                                    </div>
                                    <div class="legend-value">
                                        {{ dashboard?.attendanceSummary?.presentCount || 0 }} buổi
                                        ({{ presentPercent | number:'1.0-1' }}%)
                                    </div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-label">
                                        <div class="legend-color absent"></div> Vắng mặt
                                    </div>
                                    <div class="legend-value">
                                        {{ dashboard?.attendanceSummary?.absentCount || 0 }} buổi
                                        ({{ absentPercent | number:'1.0-1' }}%)
                                    </div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-label">
                                        <div class="legend-color late"></div> Đi muộn
                                    </div>
                                    <div class="legend-value">
                                        {{ dashboard?.attendanceSummary?.lateCount || 0 }} buổi
                                        ({{ latePercent | number:'1.0-1' }}%)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end chart-card -->
                </div>
            </div>
        </main>
    </div>

</body>