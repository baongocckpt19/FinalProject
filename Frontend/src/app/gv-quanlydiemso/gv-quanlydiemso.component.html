<body>
    <div class="dashboard-container">
        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Content -->
            <main class="dashboard-content">
                <!-- Page Header -->
                <div class="page-header">
                    <div class="page-title-section">
                        <h2 class="page-title">Qu·∫£n l√Ω ƒëi·ªÉm s·ªë</h2>
                        <p class="page-subtitle">Nh·∫≠p v√† qu·∫£n l√Ω ƒëi·ªÉm s·ªë cho sinh vi√™n</p>
                    </div>

                    <div class="page-actions">
                        <button class="btn btn-outline" (click)="openFileImportModal()">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
                            </svg>
                            Nh·∫≠p t·ª´ file
                        </button>
                        <button class="btn btn-outline" (click)="openBulkGradeInputModal()">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M19,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.9 20.1,3 19,3M19,19H5V5H19V19Z" />
                            </svg>
                            Nh·∫≠p h√†ng lo·∫°t
                        </button>
                        <button class="btn btn-outline" onclick="exportGrades()">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
                            </svg>
                            Xu·∫•t b√°o c√°o
                        </button>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">T·ªïng sinh vi√™n</span>
                            <div class="stat-icon blue">
                                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zM4 18v-4h3v4h2v-7.5c0-.83.67-1.5 1.5-1.5S12 9.67 12 10.5V11h2.5c.83 0 1.5.67 1.5 1.5V18h2v4H4v-4z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value">288</div>
                        <div class="stat-change positive">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M7 14l5-5 5 5z" />
                            </svg>
                            +12 t·ª´ tu·∫ßn tr∆∞·ªõc
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">ƒêi·ªÉm trung b√¨nh</span>
                            <div class="stat-icon green">
                                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value">7.8</div>
                        <div class="stat-change positive">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M7 14l5-5 5 5z" />
                            </svg>
                            +0.3 ƒëi·ªÉm
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">T·ª∑ l·ªá ƒë·∫≠u</span>
                            <div class="stat-icon orange">
                                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L20.29,9.12L22.59,11.41L24,10L16,6Z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value">92%</div>
                        <div class="stat-change positive">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M7 14l5-5 5 5z" />
                            </svg>
                            +5% t·ª´ k·ª≥ tr∆∞·ªõc
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">C·∫ßn c·∫£i thi·ªán</span>
                            <div class="stat-icon red">
                                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value">23</div>
                        <div class="stat-change negative">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M7 10l5 5 5-5z" />
                            </svg>
                            -8 sinh vi√™n
                        </div>
                    </div>
                </div>

                <!-- Grade Management -->
                <div class="grade-management">
                    <div class="grade-header">
                        <h3>B·∫£ng ƒëi·ªÉm sinh vi√™n</h3>
                        <div class="grade-actions">
                            <span style="color: #64748b; font-size: 14px;">L·ªõp: L·∫≠p tr√¨nh Web (IT301)</span>
                        </div>
                    </div>

                    <div class="filter-bar">
                        <div class="filter-group">
                            <select class="filter-select" id="classFilter">
                                <option value="IT301">L·∫≠p tr√¨nh Web (IT301)</option>
                                <option value="IT302">C∆° s·ªü d·ªØ li·ªáu (IT302)</option>
                                <option value="IT303">Thu·∫≠t to√°n (IT303)</option>
                                <option value="IT304">H·ªá th·ªëng th√¥ng tin (IT304)</option>
                            </select>
                        </div>

                        <div class="search-actions">
                            <!-- button ·∫©n hi·ªán ƒëi·ªÉm -->
                            <button class="btn-compact btn-outline" (click)="toggleGradeVisibility()"
                                id="toggleGradeBtn">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                    <path *ngIf="!isGradeVisible"
                                        d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" />
                                    <path *ngIf="isGradeVisible" d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74
                                         7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 
                                         4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 
                                         0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z" />
                                </svg>
                                {{ isGradeVisible ? '·∫®n ƒëi·ªÉm' : 'Hi·ªán ƒëi·ªÉm' }}
                            </button>
                            <!-- button l∆∞u t·∫•t c·∫£ -->
                            <button class="btn-compact btn-success" (click)="saveAllGrades()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3M19,19H5V5H16.17L19,7.83V19M12,12C10.34,12 9,13.34 9,15C9,16.66 10.34,18 12,18C13.66,18 15,16.66 15,15C15,13.34 13.66,12 12,12Z" />
                                </svg>
                                L∆∞u t·∫•t c·∫£
                            </button>
                            <!-- search box -->
                            <div class="search-box">
                                <svg class="search-icon" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                                </svg>
                                <input type="text" id="studentSearchInput" placeholder="T√¨m ki·∫øm sinh vi√™n..."
                                    class="search-input" [(ngModel)]="searchText" (input)="searchStudent()">
                            </div>
                        </div>
                    </div>
                    <!-- b·∫£ng ƒëi·ªÉm -->
                    <div class="grade-table-container">
                        <table class="grade-table">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th (click)="sortBy('ten')" class="sortable">
                                        Sinh vi√™n
                                        <span *ngIf="currentSortColumn === 'ten'">
                                            {{ isAscending ? '‚Üë' : '‚Üì' }}
                                        </span>
                                    </th>

                                    <th (click)="sortBy('diemChuyenCan')" class="sortable">
                                        ƒêi·ªÉm chuy√™n c·∫ßn
                                        <span *ngIf="currentSortColumn === 'diemChuyenCan'">
                                            {{ isAscending ? '‚Üë' : '‚Üì' }}
                                        </span>
                                    </th>

                                    <th (click)="sortBy('diemGiuaKy')" class="sortable">
                                        ƒêi·ªÉm gi·ªØa k·ª≥
                                        <span *ngIf="currentSortColumn === 'diemGiuaKy'">
                                            {{ isAscending ? '‚Üë' : '‚Üì' }}
                                        </span>
                                    </th>

                                    <th (click)="sortBy('diemCuoiKy')" class="sortable">
                                        ƒêi·ªÉm cu·ªëi k·ª≥
                                        <span *ngIf="currentSortColumn === 'diemCuoiKy'">
                                            {{ isAscending ? '‚Üë' : '‚Üì' }}
                                        </span>
                                    </th>
                                    <th (click)="sortBy('diemTrungbinh')" class="sortable">
                                        ƒêi·ªÉm trung b√¨nh
                                        <span *ngIf="currentSortColumn === 'diemTrungbinh'">
                                            {{ isAscending ? '‚Üë' : '‚Üì' }}
                                        </span>
                                    </th>
                                    <th>X·∫øp lo·∫°i</th>
                                    <th>H√†nh ƒë·ªông</th>
                                </tr>
                            </thead>
                            <tbody id="gradeTableBody">
                                <tr *ngFor="let sinhVien of sv; let i = index">
                                    <td>{{i+1}}</td>
                                    <td>
                                        <div class="student-info">
                                            <div class="student-details">
                                                <h5>{{sinhVien.ho}} {{sinhVien.ten}}</h5>
                                                <p>MSSV: {{sinhVien.mssv}}</p>
                                            </div>
                                        </div>
                                    </td>
                                    <td><input type="number" class="grade-input" min="0" max="10" step="0.1"
                                            [(ngModel)]="sinhVien.diemChuyenCan" (ngModelChange)="diemTB()"></td>
                                    <td><input type="number" class="grade-input" min="0" max="10" step="0.1"
                                            [(ngModel)]="sinhVien.diemGiuaKy" (ngModelChange)="diemTB()"></td>
                                    <td><input type="number" class="grade-input" min="0" max="10" step="0.1"
                                            [(ngModel)]="sinhVien.diemCuoiKy" (ngModelChange)="diemTB()"></td>
                                    <td><span class="total-grade" id="total-1">{{sinhVien.diemTrungbinh | number
                                            :'1.1-1' }}</span></td>
                                    <td><span class="grade-badge" [ngClass]="{ 
                                                                                'excellent': sinhVien.xepLoai === 'Xu·∫•t s·∫Øc', 
                                                                                'good': sinhVien.xepLoai === 'Gi·ªèi', 
                                                                                'fair': sinhVien.xepLoai === 'Kh√°',
                                                                                'average': sinhVien.xepLoai === 'Trung b√¨nh',
                                                                                'poor': sinhVien.xepLoai === 'Y·∫øu'
                                                                             }">{{sinhVien.xepLoai}}</span></td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn-icon btn-save" (click)="saveStudentGrade(sinhVien)"
                                                title="L∆∞u ƒëi·ªÉm">
                                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                                    <path
                                                        d="M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3M19,19H5V5H16.17L19,7.83V19M12,12C10.34,12 9,13.34 9,15C9,16.66 10.34,18 12,18C13.66,18 15,16.66 15,15C15,13.34 13.66,12 12,12Z" />
                                                </svg>
                                            </button>
                                            <button class="btn-icon btn-detail"
                                                (click)="openStudentDetailModal(sinhVien)" title="Chi ti·∫øt">
                                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                                    <path
                                                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                                                </svg>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Charts and Attention List Grid -->
                <div style="display: grid; grid-template-columns: 0.6fr 1fr; gap: 24px;">
                    <!-- Grade Chart -->
                    <div class="grade-chart-container">
                        <div class="chart-header">
                            <h3 class="chart-title">Ph√¢n b·ªë ƒëi·ªÉm - L·ªõp L·∫≠p tr√¨nh Web (IT301)</h3>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #667eea;"></div>
                                    <span>S·ªë sinh vi√™n</span>
                                </div>
                            </div>
                        </div>

                        <div class="chart-content" style="height: 300px;">
                            <div class="chart-bar" *ngFor="let bar of gradeDistribution">
                                <div class="bar" [style.height]="(bar.count * 10) + 'px'" style="background: #667eea;">
                                    <div class="bar-value">{{ bar.count }}</div>
                                </div>
                                <div class="bar-label">{{ bar.range }}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Students Need Attention -->
                    <div class="grade-chart-container">
                        <div class="chart-header">
                            <h3 class="chart-title">Sinh vi√™n c·∫ßn ch√∫ √Ω</h3>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <select class="filter-select" id="attentionGradeType" [(ngModel)]="attentionGradeType"
                                    (change)="onGradeTypeChange($event)"
                                    style=" min-width: 140px; font-size: 13px; padding: 8px 12px;">
                                    <option value="average">ƒêi·ªÉm trung b√¨nh</option>
                                    <option value="attendance">ƒêi·ªÉm chuy√™n c·∫ßn</option>
                                    <option value="midterm">ƒêi·ªÉm gi·ªØa k·ª≥</option>
                                    <option value="final">ƒêi·ªÉm cu·ªëi k·ª≥</option>
                                </select>
                            </div>
                        </div>

                        <div style="height: 200px; overflow-y: auto; padding: 16px 0;">
                            <!-- N·∫øu kh√¥ng c√≥ sinh vi√™n c·∫ßn ch√∫ √Ω -->
                            <div *ngIf="attentionStudents.length === 0" class="no-attention-students">
                                <svg fill="currentColor" viewBox="0 0 24 24" width="24" height="24">
                                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
                                </svg>
                                <h4>Tuy·ªát v·ªùi!</h4>
                                <p>Kh√¥ng c√≥ sinh vi√™n n√†o c·∫ßn ch√∫ √Ω v·ªÅ {{ getGradeTypeName(attentionGradeType) }}</p>
                            </div>

                            <!-- N·∫øu c√≥ sinh vi√™n c·∫ßn ch√∫ √Ω -->
                            <div *ngIf="attentionStudents.length > 0">
                                <div class="attention-student-item" *ngFor="let student of attentionStudents"
                                    (click)="viewStudentDetail(student.id)" style="cursor: pointer;">
                                    <div class="attention-student-info">
                                        <div class="attention-student-name">{{ student.name }}</div>
                                        <div class="attention-student-id">{{ student.mssv }}</div>
                                    </div>
                                    <div class="attention-grade">
                                        <div class="attention-grade-type">{{ student.gradeLabel }}</div>
                                        <div class="attention-grade-value">{{ student.grade | number: '1.1-1' }}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
        </div>
        </main>
    </div>
    </div>

    <!-- Student Detail Modal -->
    <div class="modal-overlay active" id="studentDetailModal" *ngIf="showStudentDetailModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <div class="modal-icon info">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                    </svg>
                </div>
                <h3 class="modal-title" id="studentDetailTitle">Chi ti·∫øt ƒëi·ªÉm sinh vi√™n</h3>
            </div>

            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">H·ªç v√† t√™n</label>
                    <input type="text" class="form-input" id="studentName" [value]="selectedStudent.ho + ' ' + selectedStudent.ten" readonly>
                </div>

                <div class="form-group">
                    <label class="form-label">M√£ s·ªë sinh vi√™n</label>
                    <input type="text" class="form-input" id="studentId" [(ngModel)]="selectedStudent.mssv" readonly>
                </div>

                <div class="form-group">
                    <label class="form-label">L·ªõp h·ªçc</label>
                    <input type="text" class="form-input" id="studentClass" [(ngModel)]="selectedStudent.tenLop"
                        readonly>
                </div>

                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="studentEmail" value="nguyenvana@student.edu.vn" readonly>
                </div>
            </div>

            <div class="student-grades">
                <h4 style="margin-bottom: 16px; color: #1e293b; font-weight: 600;">Chi ti·∫øt ƒëi·ªÉm s·ªë</h4>

                <div class="grades-grid">
                    <div class="grade-item">
                        <div class="grade-item-label">ƒêi·ªÉm chuy√™n c·∫ßn</div>
                        <div class="grade-item-value" id="detailAttendance">{{selectedStudent.diemChuyenCan}}</div>
                    </div>

                    <div class="grade-item">
                        <div class="grade-item-label">ƒêi·ªÉm gi·ªØa k·ª≥</div>
                        <div class="grade-item-value" id="detailMidterm">{{selectedStudent.diemGiuaKy}}</div>
                    </div>

                    <div class="grade-item">
                        <div class="grade-item-label">ƒêi·ªÉm cu·ªëi k·ª≥</div>
                        <div class="grade-item-value" id="detailFinal">{{selectedStudent.diemCuoiKy}}</div>
                    </div>

                    <div class="grade-item">
                        <div class="grade-item-label">S·ªë bu·ªïi v·∫Øng</div>
                        <div class="grade-item-value" id="detailAbsent">2</div>
                    </div>
                </div>

                <div class="grade-summary">
                    <h4>ƒêi·ªÉm t·ªïng k·∫øt</h4>
                    <div class="final-grade" id="detailFinalGrade">{{selectedStudent.diemTrungbinh}}</div>
                    <div class="grade-status" id="detailGradeStatus">X·∫øp lo·∫°i: {{selectedStudent.xepLoai}}</div>
                </div>
            </div>

            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" (click)="closeStudentDetailModal()">ƒê√≥ng</button>
                <button class="modal-btn modal-btn-primary" onclick="printStudentReport()">In b√°o c√°o</button>
            </div>
        </div>
    </div>

    <!-- File Import Modal -->
    <div class="modal-overlay active " id="fileImportModal" *ngIf="showFileImportModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <div class="modal-icon info">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
                    </svg>
                </div>
                <h3 class="modal-title">Nh·∫≠p ƒëi·ªÉm t·ª´ file Excel/CSV</h3>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div>
                    <label class="form-label">Ch·ªçn l·ªõp h·ªçc</label>
                    <select class="form-input" id="fileImportClassSelect">
                        <option value="IT301">L·∫≠p tr√¨nh Web (IT301)</option>
                        <option value="IT302">C∆° s·ªü d·ªØ li·ªáu (IT302)</option>
                        <option value="IT303">Thu·∫≠t to√°n (IT303)</option>
                        <option value="IT304">H·ªá th·ªëng th√¥ng tin (IT304)</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Ch·ªçn lo·∫°i ƒëi·ªÉm</label>
                    <select class="form-input" id="fileImportGradeType">
                        <option value="attendance">ƒêi·ªÉm chuy√™n c·∫ßn</option>
                        <option value="midterm">ƒêi·ªÉm gi·ªØa k·ª≥</option>
                        <option value="final">ƒêi·ªÉm cu·ªëi k·ª≥</option>
                        <option value="all">C·∫£ 3 ƒëi·ªÉm (chuy√™n c·∫ßn, gi·ªØa k·ª≥, cu·ªëi k·ª≥)</option>
                    </select>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label class="form-label">Ch·ªçn file Excel ho·∫∑c CSV</label>
                <input type="file" class="form-input" id="gradeFileInput" accept=".xlsx,.xls,.csv"
                    style="padding: 12px;" [(ngModel)]="newFile.gradeFile" required>
            </div>
            <div
                style="background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                <h4 style="color: #0369a1; margin-bottom: 8px; font-size: 14px;">üìã ƒê·ªãnh d·∫°ng file y√™u c·∫ßu:</h4>
                <ul style="color: #0369a1; font-size: 13px; margin-left: 20px;">
                    <li>File Excel (.xlsx, .xls) ho·∫∑c CSV (.csv)</li>
                    <li><strong>C·ªôt A:</strong> T√™n sinh vi√™n</li>
                    <li><strong>C·ªôt B:</strong> MSSV (M√£ s·ªë sinh vi√™n)</li>
                    <li><strong>C·ªôt C:</strong> ƒêi·ªÉm (n·∫øu ch·ªçn 1 lo·∫°i ƒëi·ªÉm)</li>
                    <li><strong>C·ªôt C, D, E:</strong> ƒêi·ªÉm chuy√™n c·∫ßn, gi·ªØa k·ª≥, cu·ªëi k·ª≥ (n·∫øu ch·ªçn "C·∫£ 3 ƒëi·ªÉm")</li>
                    <li>D√≤ng ƒë·∫ßu ti√™n c√≥ th·ªÉ l√† ti√™u ƒë·ªÅ (s·∫Ω ƒë∆∞·ª£c b·ªè qua)</li>
                    <li><strong>V√≠ d·ª• 1 ƒëi·ªÉm:</strong> Nguy·ªÖn VƒÉn A | 2021001 | 8.5</li>
                    <li><strong>V√≠ d·ª• 3 ƒëi·ªÉm:</strong> Nguy·ªÖn VƒÉn A | 2021001 | 8.5 | 7.8 | 8.2</li>
                </ul>
            </div>

            <div
                style="background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                <h4 style="color: #92400e; margin-bottom: 8px; font-size: 14px;">‚ö†Ô∏è L∆∞u √Ω:</h4>
                <ul style="color: #92400e; font-size: 13px; margin-left: 20px;">
                    <li>Ch·ªâ c·∫≠p nh·∫≠t ƒëi·ªÉm cho sinh vi√™n c√≥ trong l·ªõp ƒë√£ ch·ªçn</li>
                    <li>MSSV kh√¥ng t·ªìn t·∫°i s·∫Ω ƒë∆∞·ª£c b·ªè qua</li>
                    <li>ƒêi·ªÉm kh√¥ng h·ª£p l·ªá (< 0 ho·∫∑c> 10) s·∫Ω ƒë∆∞·ª£c b·ªè qua</li>
                </ul>
            </div>

            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" (click)="closeFileImportModal()">H·ªßy</button>
                <button class="modal-btn modal-btn-primary" (click)="addFile()">Nh·∫≠p ƒëi·ªÉm</button>
            </div>
        </div>
    </div>

    <!-- Bulk Grade Input Modal -->
    <div class="modal-overlay active" id="bulkGradeModal" *ngIf="showBulkGradeInputModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-icon info">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M19,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.9 20.1,3 19,3M19,19H5V5H19V19Z" />
                    </svg>
                </div>
                <h3 class="modal-title">Nh·∫≠p ƒëi·ªÉm h√†ng lo·∫°t</h3>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div>
                    <label class="form-label">Ch·ªçn l·ªõp h·ªçc</label>
                    <select class="form-input" id="bulkClassSelect">
                        <option value="IT301">L·∫≠p tr√¨nh Web (IT301)</option>
                        <option value="IT302">C∆° s·ªü d·ªØ li·ªáu (IT302)</option>
                        <option value="IT303">Thu·∫≠t to√°n (IT303)</option>
                        <option value="IT304">H·ªá th·ªëng th√¥ng tin (IT304)</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Ch·ªçn lo·∫°i ƒëi·ªÉm</label>
                    <select class="form-input" id="bulkGradeType">
                        <option value="attendance">ƒêi·ªÉm chuy√™n c·∫ßn</option>
                        <option value="midterm">ƒêi·ªÉm gi·ªØa k·ª≥</option>
                        <option value="final">ƒêi·ªÉm cu·ªëi k·ª≥</option>
                        <option value="all">C·∫£ 3 ƒëi·ªÉm (chuy√™n c·∫ßn, gi·ªØa k·ª≥, cu·ªëi k·ª≥)</option>
                    </select>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label class="form-label">Nh·∫≠p ƒëi·ªÉm (m·ªói d√≤ng m·ªôt sinh vi√™n)</label>
                <textarea class="form-input" id="bulkGradeData" rows="8" placeholder="2021001,8.5
2021002,9.2
2021003,6.5

Ho·∫∑c c·∫£ 3 ƒëi·ªÉm:
2021001,8.5,7.8,8.2
2021002,9.2,8.8,9.1" style="font-family: monospace; resize: vertical;" [(ngModel)]="newBulkGrades.grades"></textarea>
            </div>

            <div
                style="background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                <h4 style="color: #0369a1; margin-bottom: 8px; font-size: 14px;">üí° H∆∞·ªõng d·∫´n:</h4>
                <ul style="color: #0369a1; font-size: 13px; margin-left: 20px;">
                    <li>Ch·ªçn l·ªõp h·ªçc v√† lo·∫°i ƒëi·ªÉm tr∆∞·ªõc khi nh·∫≠p</li>
                    <li><strong>ƒê·ªãnh d·∫°ng 1 ƒëi·ªÉm:</strong> MSSV,ƒêi·ªÉm</li>
                    <li><strong>ƒê·ªãnh d·∫°ng 3 ƒëi·ªÉm:</strong> MSSV,ƒêi·ªÉm_CC,ƒêi·ªÉm_GK,ƒêi·ªÉm_CK</li>
                    <li>ƒêi·ªÉm t·ª´ 0 ƒë·∫øn 10, c√≥ th·ªÉ c√≥ 1 ch·ªØ s·ªë th·∫≠p ph√¢n</li>
                    <li><strong>V√≠ d·ª• 1 ƒëi·ªÉm:</strong> 2021001,8.5</li>
                    <li><strong>V√≠ d·ª• 3 ƒëi·ªÉm:</strong> 2021001,8.5,7.8,8.2</li>
                    <li>H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông t√¨m sinh vi√™n theo MSSV trong l·ªõp ƒë√£ ch·ªçn</li>
                </ul>
            </div>

            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" (click)="closeBulkGradeInputModal()">H·ªßy</button>
                <button class="modal-btn modal-btn-primary" (click)="processBulkGrades()">√Åp d·ª•ng ƒëi·ªÉm</button>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div class="modal-overlay active" id="notificationModal" *ngIf="showNotificationModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-icon" id="notificationIcon">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24" id="notificationIconSvg">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
                    </svg>
                </div>
                <h3 class="modal-title" id="notificationTitle">Th√†nh c√¥ng!</h3>
            </div>
            <p class="modal-message" id="notificationMessage">Thao t√°c ƒë√£ ƒë∆∞·ª£c th·ª±c hi·ªán th√†nh c√¥ng.</p>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" (click)="closeNotificationModal()">ƒê√≥ng</button>
            </div>
        </div>
    </div>
</body>
